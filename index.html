<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Quiz Sécurité Incendie</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Couleur pour Android (Chrome) -->
  <meta name="theme-color" content="#8000b3">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Préchargement de quelques images critiques -->
  <link rel="preload" as="image" href="images/wall.png">
  <link rel="preload" as="image" href="images/wall2.png">
  <link rel="preload" as="image" href="images/correct.png">
  <link rel="preload" as="image" href="images/incorrect.png">
  <link rel="preload" as="image" href="images/decor1.gif">
  <link rel="preload" as="image" href="images/decor2.gif">
  <link rel="preload" as="image" href="images/fire empty.png">
  <link rel="preload" as="image" href="images/fire full.png">
  <link rel="preload" as="image" href="images/ryu.gif">
  <link rel="preload" as="image" href="images/ken.gif">
  <link rel="preload" as="image" href="images/ryu2.gif">
  <link rel="preload" as="image" href="images/ken2.gif">
  <link rel="preload" as="image" href="images/mute-off.gif">
  <link rel="preload" as="image" href="images/mute-on.gif">
  <link rel="preload" as="image" href="images/perfect.gif">
  <link rel="preload" as="image" href="images/tryagain.png">
  <link rel="preload" as="image" href="images/youwin.png">
  <link rel="preload" as="image" href="images/titre.png">
  
  <style>
    /* Animations */
    @keyframes victoryAnimation {
      0% { transform: scale(1) rotate(0deg); }
      20% { transform: scale(1.1) rotate(3deg); }
      40% { transform: scale(1) rotate(-3deg); }
      60% { transform: scale(1.1) rotate(3deg); }
      80% { transform: scale(1) rotate(-3deg); }
      90% { transform: scale(1) rotate(0deg); }
      100% { transform: scale(1) rotate(0deg); }
    }
    .victory-animation {
      animation: victoryAnimation 2s ease-in-out infinite;
      transform-origin: center;
      margin-top: -20px !important;
    }
    @keyframes windmillShake {
      0% { transform: rotate(0deg); }
      15% { transform: rotate(15deg); }
      30% { transform: rotate(-15deg); }
      45% { transform: rotate(10deg); }
      60% { transform: rotate(-10deg); }
      75% { transform: rotate(5deg); }
      90% { transform: rotate(-5deg); }
      100% { transform: rotate(0deg); }
    }
    .windmill-shake {
      animation: windmillShake 0.8s ease-in-out forwards !important;
      transform-origin: center;
    }
    @keyframes levitateLeft {
      0%   { transform: translate(40px, -10px); }
      50%  { transform: translate(40px, -20px); }
      100% { transform: translate(40px, -10px); }
    }
    @keyframes levitateRight {
      0%   { transform: translate(-40px, -10px); }
      50%  { transform: translate(-40px, -20px); }
      100% { transform: translate(-40px, -10px); }
    }
    @keyframes shake {
      0% { transform: translate(0, 0); }
      10% { transform: translate(-10px, -10px); }
      20% { transform: translate(10px, 10px); }
      30% { transform: translate(-10px, 10px); }
      40% { transform: translate(10px, -10px); }
      50% { transform: translate(-10px, -10px); }
      60% { transform: translate(10px, 10px); }
      70% { transform: translate(-10px, 10px); }
      80% { transform: translate(10px, -10px); }
      90% { transform: translate(-10px, -10px); }
      100% { transform: translate(0, 0); }
    }
    @keyframes popAnimation {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    @keyframes blink {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }
    @keyframes glow-green {
      0% { box-shadow: 0 0 5px rgba(0,255,0,0.7); }
      50% { box-shadow: 0 0 20px rgba(0,255,0,0.9); }
      100% { box-shadow: 0 0 5px rgba(0,255,0,0.7); }
    }
    @keyframes borderGlow {
      0%, 100% { box-shadow: 0 0 5px 2px purple; }
      50% { box-shadow: 0 0 20px 2px purple; }
    }
    @keyframes borderGlow2 {
      0%, 100% { box-shadow: 0 0 5px 2px rgba(255,0,0,0.7); }
      50% { box-shadow: 0 0 20px 2px rgba(255,0,0,0.7); }
    }
    @keyframes borderGlowGreen {
      0%, 100% { box-shadow: 0 0 5px 2px rgba(0,255,0,0.7); }
      50% { box-shadow: 0 0 20px 2px rgba(0,255,0,0.7); }
    }
    @keyframes floatAnimation {
      0%   { transform: translateY(0); }
      50%  { transform: translateY(-10px); }
      100% { transform: translateY(0); }
    }
    .floating-title {
      position: relative;
      z-index: 3;
      animation: floatAnimation 8s ease-in-out infinite;
      display: block;
      margin: -10px auto 10px;
      max-width: 90%;
      width: auto;
    }
    .pikachu {
      display: block;
      margin: 20px auto;
      transform: translateY(-15px)!important;
      width: 270px !important;
      height: 192px !important;
      border: 3px solid white;
    }
    #result-header {
      margin-bottom: 40px;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: linear-gradient(to top, #1a001f 0%, #330033 25%, #4B0082 50%, #660099 75%, #8000b3 100%);
      background-size: 100% 100%;
      animation: quizBGAnimation 10s ease infinite;
    }
    body {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      width: 360px;
      max-width: 90%;
      background: url('images/wall.png') no-repeat center center;
      background-size: cover;
      border: 3px solid white;
      border-radius: 15px;
      text-align: center;
      padding: 30px;
      padding-top: 50px;
      margin: 20px auto;
      transition: transform 0.3s ease;
      position: relative;
    }
    /* Page d'accueil */
    #home { width: 360px; }
    #start-btn {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 140px;
      height: 80px;
      margin: 30px auto;
      padding: 5px 10px;
      font-size: 18px;
      cursor: pointer;
      background: linear-gradient(to top, black, gray);
      color: white;
      font-weight: bold;
      border: 3px solid white;
      border-radius: 10px;
      text-shadow: 1px 1px 2px black;
      transition: transform 0.1s ease-in-out;
      animation: borderGlow 2s ease-in-out infinite;
      position: relative;
      overflow: visible;
    }
    #start-btn:active {
      transform: scale(0.95);
      animation: glow-green 1.5s infinite ease-in-out, blink 0.3s infinite ease-in-out;
    }
    #start-btn img {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 120px;
      height: auto;
      pointer-events: none;
    }
    /* Zone du quiz */
    #quiz-container {
      background: url('images/wall2.png') no-repeat center center;
      background-size: cover;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      text-align: center;
      display: none;
    }
    #question-counter {
      font-weight: bold;
      margin-bottom: 5px;
      font-family: Arial, sans-serif;
      color: white;
      margin-top: -20px;
      margin-bottom: 0;
    }
    #question-text {
      width: 95%;
      margin: 0 auto;
      font-family: 'Arial Black', Arial, sans-serif;
      font-weight: bold;
      font-size: 22px;
      margin-bottom: 15px;
      color: white;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      line-height: 1.5;
    }
    .options {
      font-family: Arial, sans-serif;
      font-weight: normal;
      font-size: 18px;
      color: white;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      text-align: left;
      margin: 0;
      margin-bottom: 20px;
      margin-left: 20px;
      padding-left: 20px;
    }
    .option {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      margin-bottom: 10px;
    }
    .option input[type="checkbox"] { display: none; }
    .option label { display: inline-flex; align-items: center; }
    .option label:before {
      content: "";
      display: inline-block;
      width: 45px;
      height: 45px;
      margin-right: 8px;
      margin-left: -50px;
      background: url('images/fire empty.png') no-repeat center;
      background-size: contain;
      flex-shrink: 0;
    }
    .option input[type="checkbox"]:checked + label:before {
      background: url('images/fire full.png') no-repeat center;
      background-size: contain;
      width: 45px;
      height: 45px;
    }
    #validate-btn {
      font-weight: bold;
      margin: 0 auto;
      margin-top: 30px;
      display: block;
      padding: 15px 25px;
      font-size: 25px;
      border: 3px solid white;
      border-radius: 10px;
      background-color: #1a1d21;
      color: white;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
      animation: borderGlow 2s ease-in-out infinite;
    }
    #validate-btn:active { transform: translateY(2px) scale(0.98); }
    #result { margin-top: 20px; }
    .result-image {
      width: 60px;
      display: block;
      margin: 10px auto;
    }
    .incorrect-answer-text {
      color: red;
      font-size: 20px;
      font-weight: bold;
      font-family: 'Arial Black', Arial, sans-serif;
      text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff, 3px 3px 5px black;
      margin-bottom: 10px;
      margin-top: 5px;
    }
    .incorrect-answer-header {
      margin-top: 0;
      font-weight: bold;
      font-size: 18px;
      font-family: 'Arial Black', Arial, sans-serif;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      color: white;
    }
    .correct-container {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .correct-decoration { width: 60px; }
    .correct-container .result-image.correct {
      animation: popAnimation 0.5s ease-out;
      width: 80px;
      margin-bottom: 10px;
      margin-top: -10px;
      z-index: 1;
    }
    .result-image.incorrect {
      width: 80px;
      animation: shake 0.5s ease-in-out;
      margin-top: -30px;
    }
    /* Page finale */
    #result-page {  
      background: url('images/wall.png') no-repeat center center;
      display: none; 
      position: relative;
    }
    #result-page h2 { font-size: 24px; margin-bottom: 20px; }
    #final-score {
      margin-top: -15px;
      margin-bottom: 15px;
      font-weight: bold;
      font-size: 25px;
      font-family: 'Arial Black', Arial, sans-serif;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      color: #00ff1a;
    }
    #restart-btn {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 160px;
      height: 65px;
      margin: 20px auto;
      padding: 5px 20px;
      font-size: 18px;
      cursor: pointer;
      background: linear-gradient(to top, black, gray);
      color: white;
      font-weight: bold;
      border: 2px solid white;
      border-radius: 10px;
      text-shadow: 1px 1px 2px black;
      transition: transform 0.1s ease-in-out;
      position: relative;
      overflow: visible;
      animation: borderGlow2 2s ease-in-out infinite;
      z-index: 6; 
    }
    #restart-btn:active { transform: scale(0.95); }
    .incorrect-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: -30px;
    }
    .decor-rightX {
      width: 60px;
      transform: translate(-30px, 3px) scale(3);
      z-index: 0;
      padding: 12px 0;
      animation: levitateRightX 1s ease-in-out infinite;
    }
    .decor-leftX {
      width: 60px;
      transform: translate(30px, 3px) scale(1.5);
      z-index: 0;
      padding: 12px 0;
      animation: levitateLeftX 1s ease-in-out infinite;
    }
    .decor-right {
      width: 60px;
      transform: translate(-40px, 0);
      z-index: 0;
      padding: 12px 0;
      animation: levitateRight 1s ease-in-out infinite;
    }
    .decor-left {
      width: 60px;
      transform: translate(40px, 0);
      z-index: 0;
      padding: 12px 0;
      animation: levitateLeft 1s ease-in-out infinite;
    }
    @keyframes levitateLeftX {
      0%   { transform: translate(40px, -20px); }
      50%  { transform: translate(40px, -30px); }
      100% { transform: translate(40px, -20px); }
    }
    @keyframes levitateRightX {
      0%   { transform: translate(-40px, -20px); }
      50%  { transform: translate(-40px, -30px); }
      100% { transform: translate(-40px, -20px); }
    }
    /* Media Query pour mobile */
    @media (max-width: 480px) {
      .container {       
        width: 360px;
        max-width: 90%;
        padding: 30px;
      }
      #overlay {
        top: 85px !important;
        left: 50% !important;
        transform: translateX(-50%) !important;
      }
      #question-text { font-size: 18px; }
      #final-score { font-size: 20px; }
      .floating-title { margin: 0 auto 0; }
      .pikachu { display: block; }
      .startu { border-radius: 10px; }
      .incorrect-container {
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .again {
        display: block;
        margin: 0 auto;
        transform: translateX(0);
      }
      @keyframes windmillShake {
        0% { transform: rotate(0deg); }
        15% { transform: rotate(15deg); }
        30% { transform: rotate(-15deg); }
        45% { transform: rotate(10deg); }
        60% { transform: rotate(-10deg); }
        75% { transform: rotate(5deg); }
        100% { transform: rotate(0deg); }
      }
      .windmill-shake {
        animation: windmillShake 0.8s ease-in-out forwards;
        transform-origin: center;
      }
      .raised {
        transform: translateY(-20px);
        margin-bottom: -10px !important;
      }
      @keyframes victoryAnimation {
        0% { transform: scale(1) rotate(0deg); }
        20% { transform: scale(1.1) rotate(3deg); }
        40% { transform: scale(1) rotate(-3deg); }
        60% { transform: scale(1.1) rotate(3deg); }
        80% { transform: scale(1) rotate(-3deg); }
        90% { transform: scale(1) rotate(0deg); }
        100% { transform: scale(1) rotate(0deg); }
      }
      .victory-animation {
        animation: victoryAnimation 2s ease-in-out infinite;
        transform-origin: center;
      }
    }
    @media (max-width: 480px) {
      @keyframes levitateLeft {
        0%   { transform: translate(20px, -5px); }
        50%  { transform: translate(20px, -15px); }
        100% { transform: translate(20px, -5px); }
      }
      @keyframes levitateRight {
        0%   { transform: translate(-20px, -5px); }
        50%  { transform: translate(-20px, -15px); }
        100% { transform: translate(-20px, -5px); }
      }
    }
    @media (max-width: 480px) {
      @keyframes levitateLeftX {
        0%   { transform: translate(30px, -30px); }
        50%  { transform: translate(30px, -20px); }
        100% { transform: translate(30px, -30px); }
      }
      @keyframes levitateRightX {
        0%   { transform: translate(-30px, -30px); }
        50%  { transform: translate(-30px, -20px); }
        100% { transform: translate(-30px, -30px); }
      }
    }
    .centipod {
      display: block;
      margin: 0 auto;
    }
    @media (max-width: 480px) {
      #question-text { font-size: 20px; }
    }
    @media (max-width: 480px) {
      #final-score { font-size: 28px !important; }
    }
    @media (max-width: 480px) {
      #mute-btn { margin-bottom: 0px!important; }
    }
    @media (max-width: 480px) {
      #result-page { padding-top: 70px; }
    }
    @media (max-width: 480px) {
      .victory-animation {
        animation: mobileVictoryAnimation 2s ease-in-out infinite !important;
      }
    }
    @keyframes mobileVictoryAnimation {
      0%   { transform: translateY(-60px) scale(1) rotate(0deg); }
      20%  { transform: translateY(-60px) scale(1.1) rotate(3deg); }
      40%  { transform: translateY(-60px) scale(1) rotate(-3deg); }
      60%  { transform: translateY(-60px) scale(1.1) rotate(3deg); }
      80%  { transform: translateY(-60px) scale(1) rotate(-3deg); }
      100% { transform: translateY(-60px) scale(1) rotate(0deg); }
    }
    @media (max-width: 480px) {
      .perfect-img {
        margin-bottom: 30px!important;
      }
    }
    @media (max-width: 480px) {
      .mobile-youwin {
        margin-top: 20px !important;
        margin-bottom: -30px !important;
      }
    }
    .index-btn {
  width: 80px;
  height: 40px;
  font-size: 14px;
  margin: 10px auto 0;
  display: block;
  cursor: pointer;
  background: linear-gradient(to top, black, gray);
  color: white;
  font-weight: bold;
  border: 2px solid white;
  border-radius: 10px;
  text-shadow: 1px 1px 2px black;
  transition: transform 0.1s ease-in-out;
  animation: borderGlow 2s ease-in-out infinite;
}
.index-btn:active {
  transform: scale(0.95);
}

/* Modal INDEX */
#index-modal {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0,0,0,0.5);
  padding: 20px;
  border-radius: 15px;
  z-index: 1000;
  text-align: center;
  width: 300px;
  max-width: 80%;
}
#index-modal .index-option {
  width: 60px;
  height: 60px;
  margin: 0 10px;
  font-size: 18px;
  border: 2px solid white;
  border-radius: 50%;
  background: linear-gradient(to top, black, gray);
  color: white;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.1s ease-in-out;
}
#index-modal .index-option:active {
  transform: scale(0.95);
}
#index-modal #close-index-modal {
  margin-top: 20px;
  padding: 8px 16px;
  font-size: 16px;
  border: 2px solid white;
  border-radius: 5px;
  background: linear-gradient(to top, black, gray);
  color: white;
  cursor: pointer;
  transition: transform 0.1s ease-in-out;
}
      @media (max-width: 480px) {
  #quiz-container {
    max-height: 80vh; /* 80% de la hauteur de l'écran */
    overflow-y: auto; /* Ajoute une barre de défilement verticale si nécessaire */
  }
}
  </style>
</head>
<body>
  <!-- Éléments audio -->
  <audio id="checkbox-sound" src="audio/select.mp3" preload="auto"></audio>
  <audio id="start-sound" src="audio/start.mp3" preload="auto"></audio>
  <audio id="correct-sound" src="audio/correct.mp3" preload="auto"></audio>
  <audio id="incorrect-sound" src="audio/incorrect.mp3" preload="auto"></audio>
  <audio id="incorrect-sound2" src="audio/incorrect2.mp3" preload="auto"></audio>
  <audio id="perfect-sound" src="audio/perfect.mp3" preload="auto"></audio>
  <audio id="imperfect-sound" src="audio/imperfect.mp3" preload="auto"></audio>
  
  <!-- Page d'accueil -->
  <div class="container" id="home">
    <img src="images/titre.png" alt="quiz ssiap1" class="floating-title">
    <img src="images/decor1.gif" alt="pik" class="pikachu" style="z-index: 3;">
    <div class="mute-wrapper" style="position: relative; display: inline-block; text-align: center;">
    <img id="mute-btn" src="images/mute-off.gif" alt="Son activé" style="cursor: pointer; width: 30px; height: 25px; margin: 10px auto; display: block;">
    <img id="additional-image" src="images/diez.png" alt="Nouvelle image" 
         style="position: absolute; right: -120px; top: 50%; transform: translateY(-50%); cursor: pointer; width: 60px;">
  </div>
    <button id="start-btn"><img src="images/start.png" style="margin-bottom: -15px; width: 130px"></button>
    <button id="home-index-btn" class="index-btn">INDEX</button>
  </div>
  
  <!-- Zone du quiz -->
  <div class="container" id="quiz-container">
    <div id="question-counter">Question 1 / 3</div>
    <div id="question-text">[Texte de la question]</div>
    <div class="options" id="options">
      <!-- Options générées dynamiquement -->
    </div>
    <button id="validate-btn">Valider</button>
    <div id="result"></div>
  </div>
  
  <!-- Page de résultats finale -->
  <div class="container" id="result-page">
    <img id="result-header" src="images/tryagain.png" alt="encore" class="again">
    <img id="final-image" src="images/lose2.gif" alt="Résultat" style="display:block; margin: -15px auto 20px;">
    <p id="final-score">Score : 0 sur 3</p>
    <button id="restart-btn" style="text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;">RECOMMENCER</button>
    <button id="result-index-btn" class="index-btn">INDEX</button>
  </div>

  <div id="index-modal">
  <button class="index-option" data-url="https://remi-mason.github.io/quiz-5/">1</button>
  <button class="index-option" data-url="https://remi-mason.github.io/quiz-5-2/">2</button>
  <button class="index-option" data-url="https://remi-mason.github.io/quiz-5-3/">3</button>
  <br>
      <button class="index-option" data-url="https://remi-mason.github.io/quiz-5-4/" style="margin-top:20px;">4</button>
    <br>
  <button id="close-index-modal">Fermer</button>
</div>
  
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var decorImage = document.querySelector('.pikachu');
      if (decorImage) {
        decorImage.src = "images/decor1.gif";
        decorImage.style.width = "235px";
        setTimeout(function(){
          decorImage.src = "images/decor2.gif";
          decorImage.style.width = "235px";
        }, 18000);
      }
    });
    // Données du quiz
    const quizData = [
  {
            "question": "Que signifie l'acronyme D.M. ?",
            "options": [
                "Déclencheur Manuel.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Déclencheur Manuel."
            ]
        },
        {
            "question": "Que signifie l'acronyme D.S. ?",
            "options": [
                "Diffuseur Sonore.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Diffuseur Sonore."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.A. ?",
            "options": [
                "Équipement d'Alarme.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Équipement d'Alarme."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.A.I. ?",
            "options": [
                "Installation d’Extincteur Automatique d’Incendie.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Installation d’Extincteur Automatique d’Incendie."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.C.S. ?",
            "options": [
                "Équipement de Contrôle et de Signalisation.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Équipement de Contrôle et de Signalisation."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.C.S.A.V. ?",
            "options": [
                "Équipement de Contrôle et de Signalisation d’Alarme Vocale.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Équipement de Contrôle et de Signalisation d’Alarme Vocale."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.O.P. ?",
            "options": [
                "Établissement Ouvert au Public.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Établissement Ouvert au Public."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. ?",
            "options": [
                "Établissement Recevant du Public.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Établissement Recevant du Public."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. C.T.S. ?",
            "options": [
                "Chapiteaux, Tentes et Structures Itinérants.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Chapiteaux, Tentes et Structures Itinérants."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. F. ?",
            "options": [
                "Établissements Flottants (eaux intérieures).",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Établissements Flottants (eaux intérieures)."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. P. ?",
            "options": [
                "Salles de danse et salles de jeux.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Salles de danse et salles de jeux."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. G.A. ?",
            "options": [
                "Gares Accessibles au public.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Gares Accessibles au public."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. J. ?",
            "options": [
                "Structures d’accueil pour personnes âgées et personnes handicapées.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Structures d’accueil pour personnes âgées et personnes handicapées."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. L. ?",
            "options": [
                "Salles d’audition, de conférence, de réunions, de spectacles ou à usages multiples.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Salles d’audition, de conférence, de réunions, de spectacles ou à usages multiples."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. M. ?",
            "options": [
                "Magasins de vente, centres commerciaux.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Magasins de vente, centres commerciaux."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. N. ?",
            "options": [
                "Restaurants et débits de boisson.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Restaurants et débits de boisson."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. O. ?",
            "options": [
                "Hôtels, pension de famille.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Hôtels, pension de famille."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. O.A. ?",
            "options": [
                "Hôtel-restaurant d’Altitude.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Hôtel-restaurant d’Altitude."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. P.A. ?",
            "options": [
                "Établissements Plein Air.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Établissements Plein Air."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. P.S. ?",
            "options": [
                "Parcs de Stationnement couverts.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Parcs de Stationnement couverts."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. R. ?",
            "options": [
                "Établissements d’enseignement et colonies de vacances.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Établissements d’enseignement et colonies de vacances."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. R.E.F. ?",
            "options": [
                "REFuges de montagne.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "REFuges de montagne."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. S. ?",
            "options": [
                "Bibliothèques, centres de documentation.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Bibliothèques, centres de documentation."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. S.G. ?",
            "options": [
                "Structures Gonflables.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Structures Gonflables."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. T. ?",
            "options": [
                "Salles d’expositions à vocation commerciale.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Salles d’expositions à vocation commerciale."
            ]
        },
        {
            "question": "Que signifie l'acronyme E.R.P. U. ?",
            "options": [
                "Établissement de soins.",
                "Système de ventilation incendie",
                "Type d'extincteur spécifique",
                "Norme de construction en ERP",
                "Aucune des réponses"
            ],
            "correctAnswers": [
                "Établissement de soins."
            ]
        }
    ];
     // Fonction de mélange (shuffle) avec l'algorithme Fisher-Yates
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

// Mélange des questions
shuffleArray(quizData);
    let currentQuestion = 0;
    let score = 0;
    let isMuted = false;
    
    // Références aux éléments
    const homeDiv = document.getElementById("home");
    const quizContainer = document.getElementById("quiz-container");
    const resultPage = document.getElementById("result-page");
    const questionCounterEl = document.getElementById("question-counter");
    const questionTextEl = document.getElementById("question-text");
    const optionsDiv = document.getElementById("options");
    const resultDiv = document.getElementById("result");
    const finalScoreEl = document.getElementById("final-score");
    const finalImage = document.getElementById("final-image");
    
    const startBtn = document.getElementById("start-btn");
    const validateBtn = document.getElementById("validate-btn");
    const restartBtn = document.getElementById("restart-btn");
    const muteBtn = document.getElementById("mute-btn");
    
    const checkboxSound = document.getElementById("checkbox-sound");
    const startSound = document.getElementById("start-sound");
    const correctSound = document.getElementById("correct-sound");
    const incorrectSound = document.getElementById("incorrect-sound");
    
    // Fonction de basculement mute
    function muteToggleHandler() {
      isMuted = !isMuted;
      [startSound, correctSound, incorrectSound, checkboxSound,
       document.getElementById("perfect-sound"),
       document.getElementById("imperfect-sound")
      ].forEach(audio => { audio.muted = isMuted; });
      if (isMuted) {
        this.src = "images/mute-on.gif";
        this.alt = "Son désactivé";
      } else {
        this.src = "images/mute-off.gif";
        this.alt = "Son activé";
      }
    }
    muteBtn.addEventListener("click", muteToggleHandler);
    document.addEventListener("DOMContentLoaded", function() {
      var muteImg = document.getElementById("mute-btn");
      if (muteImg && muteImg.src.indexOf(".gif") !== -1) {
        var newMuteImg = muteImg.cloneNode(true);
        newMuteImg.src = newMuteImg.src.split('?')[0] + '?t=' + new Date().getTime();
        muteImg.parentNode.replaceChild(newMuteImg, muteImg);
        newMuteImg.addEventListener("click", muteToggleHandler);
      }
    });
    
    // Démarrage du quiz
    startBtn.addEventListener("click", () => {
      if (screen.orientation && screen.orientation.lock) {
        screen.orientation.lock("portrait").catch(error => { console.log("Le verrouillage de l'orientation a échoué :", error); });
      }
      startSound.play();
      startBtn.style.boxShadow = "0 0 20px rgba(0, 255, 0, 1)";
      startBtn.style.animation = "blink 0.3s infinite ease-in-out";
      setTimeout(() => {
        startBtn.style.animation = "glow-green 1.5s infinite ease-in-out";
        homeDiv.style.display = "none";
        quizContainer.style.display = "block";
        currentQuestion = 0;
        score = 0;
        showQuestion();
      }, 1500);
    });
    
    // Affichage de la question
   function showQuestion() {
  resultDiv.innerHTML = "";
  const data = quizData[currentQuestion];

  // Mélanger les options avant de les afficher
  shuffleArray(data.options);

  questionCounterEl.textContent = `${currentQuestion + 1} / ${quizData.length}`;
  questionTextEl.textContent = data.question;
  optionsDiv.innerHTML = "";

  data.options.forEach((option, index) => {
    const div = document.createElement("div");
    div.className = "option";
    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.value = option;
    checkbox.name = "option";
    checkbox.id = `option_${index}`;
    checkbox.addEventListener("click", () => { 
      checkboxSound.currentTime = 0; 
      checkboxSound.play(); 
    });
    const label = document.createElement("label");
    label.htmlFor = `option_${index}`;
    label.textContent = option;
    div.appendChild(checkbox);
    div.appendChild(label);
    optionsDiv.appendChild(div);
  });
}

    
    // Comparaison des tableaux
    function arraysEqual(a, b) {
      if (a.length !== b.length) return false;
      const sortedA = a.slice().sort();
      const sortedB = b.slice().sort();
      return sortedA.every((val, index) => val === sortedB[index]);
    }
    
    validateBtn.addEventListener("click", () => {
      const data = quizData[currentQuestion];
      const selected = Array.from(document.querySelectorAll('input[name="option"]:checked')).map(el => el.value);
      if (selected.length === 0) { 
        alert("Veuillez sélectionner au moins une réponse"); 
        return; 
      }
      const isCorrect = arraysEqual(selected, data.correctAnswers);
      validateBtn.style.display = "none";
      
      if (isCorrect) {
        score++;
        correctSound.currentTime = 0;
        correctSound.play();
        resultDiv.innerHTML = `
          <div class="correct-container">
            <img src="images/ryu.gif" alt="Décoration gauche" class="decor-left">
            <img src="images/correct.png" alt="Bonne réponse" class="result-image correct">
            <img src="images/ken.gif" alt="Décoration droite" class="decor-right">
          </div>
        `;
        // Passage automatique à la question suivante après 2 secondes
        setTimeout(() => {
          currentQuestion++;
          if (currentQuestion < quizData.length) {
            showQuestion();
            validateBtn.style.display = "block";
            resultDiv.innerHTML = "";
          } else {
            showResultPage();
          }
        }, 2000);
      } else {
        // Réponse incorrecte : on affiche immédiatement le résultat
        const selectedSound = (Math.random() < 0.5) ? incorrectSound : document.getElementById("incorrect-sound2");
        selectedSound.currentTime = 0;
        selectedSound.play();
        resultDiv.innerHTML = `
          <div class="incorrect-container">
            <img src="images/ryu2.gif" alt="Décoration gauche" class="decor-leftX">
            <img src="images/incorrect.png" alt="Mauvaise réponse" class="result-image incorrect">
            <img src="images/ken2.gif" alt="Décoration droite" class="decor-rightX">
          </div>
          <div class="incorrect-answer-header">Réponse :</div>
          <div class="incorrect-answer-text">${data.correctAnswers.join(", ")}</div>
        `;
        // Après 2 secondes, on remplace l'image incorrecte par un bouton "Suivant" et on supprime les décorations
        setTimeout(() => {
          const container = document.querySelector(".incorrect-container");
          if (container) {
            container.innerHTML = ""; // supprimer ryu2.gif et ken2.gif ainsi que l'image incorrecte
          }
          // Création du bouton "Suivant"
          const nextBtn = document.createElement("button");
          nextBtn.textContent = "Suivant";
          nextBtn.style.fontWeight = "bold";
          nextBtn.style.margin = "20px auto 10px";
          nextBtn.style.display = "block";
          nextBtn.style.padding = "15px 25px";
          nextBtn.style.fontSize = "25px";
          nextBtn.style.border = "3px solid white";
          nextBtn.style.borderRadius = "10px";
          nextBtn.style.backgroundColor = "#1a1d21";
          nextBtn.style.color = "white";
          nextBtn.style.cursor = "pointer";
          nextBtn.style.transition = "transform 0.1s ease, box-shadow 0.1s ease";
          nextBtn.style.animation = "borderGlow 2s ease-in-out infinite";
          // Insertion du bouton avant le bloc "Réponse :"
          const header = document.querySelector(".incorrect-answer-header");
          resultDiv.insertBefore(nextBtn, header);
          nextBtn.addEventListener("click", () => {
            // Au clic, on passe à la question suivante
            currentQuestion++;
            if (currentQuestion < quizData.length) {
              showQuestion();
              validateBtn.style.display = "block";
              resultDiv.innerHTML = "";
            } else {
              showResultPage();
            }
          });
        }, 2000);
      }
    });
    
    // Affichage de la page finale
    function showResultPage() {
      quizContainer.style.display = "none";
      resultPage.style.display = "block";
      const resultHeader = document.getElementById("result-header");
    
      if (score === quizData.length) {
        restartBtn.style.animation = "borderGlowGreen 2s ease-in-out infinite";
        resultPage.style.background = "url('images/wall.png') no-repeat center center";
        resultHeader.src = "images/youwin.png";
        resultHeader.classList.add("victory-animation");
        resultHeader.style.marginBottom = "10px";
        if (window.innerWidth <= 480) {
          resultHeader.classList.add("mobile-youwin");
        } else {
          resultHeader.style.transform = "translateX(0)";
          resultHeader.style.marginTop = "10px";
        }
        finalScoreEl.style.color = "#00ff1a";
        finalImage.classList.add("raised");
        finalImage.style.width = (window.innerWidth <= 480) ? "150px" : "190px";
        if (window.innerWidth <= 480) {
          finalImage.style.marginTop = "-25px";
          finalImage.style.marginBottom = "10px";
        } else {
          finalImage.style.marginTop = "";
          finalImage.style.marginBottom = "";
        }
        if (!document.getElementById("confet-overlay")) {
          let overlay = document.createElement("img");
          overlay.id = "confet-overlay";
          overlay.src = "images/confet.gif";
          overlay.alt = "Overlay de victoire";
          overlay.style.position = "absolute";
          overlay.style.top = "0";
          overlay.style.left = "0";
          overlay.style.width = "100%";
          overlay.style.height = "100%";
          overlay.style.objectFit = "cover";
          overlay.style.zIndex = "5";
          resultPage.appendChild(overlay);
        }
      } else {
        restartBtn.style.animation = "borderGlow2 2s ease-in-out infinite";
        resultPage.style.background = "url('images/wall2.png') no-repeat center center";
        resultHeader.src = "images/tryagain.png";
        if (window.innerWidth <= 480) {
          resultHeader.style.transform = "translateY(-40px)";
          resultHeader.style.marginTop = "-40px";
        } else {
          resultHeader.style.transform = "translateY(-20px)";
          resultHeader.style.marginTop = "-30px";
        }
        finalScoreEl.style.color = "red";
        resultHeader.classList.add("windmill-shake");
        finalImage.classList.remove("raised");
        finalImage.style.width = "190px";
        finalImage.style.transform = "";
        setInterval(() => {
          resultHeader.classList.remove("windmill-shake");
          void resultHeader.offsetWidth;
          resultHeader.classList.add("windmill-shake");
        }, 2800);
      }
    
      resultPage.style.backgroundSize = "cover";
      resultPage.style.backgroundPosition = "center";
      finalScoreEl.textContent = `Score : ${score} sur ${quizData.length}`;
    
      if (score === quizData.length) {
        finalImage.src = "images/perfect.gif";
        finalImage.classList.add("perfect-img");
        finalImage.style.marginBottom = "30px";
      } else {
        finalImage.src = "images/lose2.gif";
      }
    
      if (score === quizData.length) {
        document.getElementById("perfect-sound").currentTime = 0;
        document.getElementById("perfect-sound").play();
      } else {
        document.getElementById("imperfect-sound").currentTime = 0;
        document.getElementById("imperfect-sound").play();
      }
    }
    
    restartBtn.addEventListener("click", () => { window.location.reload(); });
    document.addEventListener("DOMContentLoaded", function() {
      var decorImage = document.querySelector('.pikachu');
      if (decorImage) {
        decorImage.src = "images/decor1.gif?t=" + new Date().getTime();
        decorImage.style.visibility = 'visible';
      }
    });
    document.addEventListener("DOMContentLoaded", function(){
  const indexModal = document.getElementById("index-modal");
  const closeIndexModal = document.getElementById("close-index-modal");
  const homeIndexBtn = document.getElementById("home-index-btn");
  const resultIndexBtn = document.getElementById("result-index-btn");
  
  if(homeIndexBtn) {
    homeIndexBtn.addEventListener("click", function(){
      indexModal.style.display = "block";
    });
  }
  
  if(resultIndexBtn) {
    resultIndexBtn.addEventListener("click", function(){
      indexModal.style.display = "block";
    });
  }
  
  if(closeIndexModal) {
    closeIndexModal.addEventListener("click", function(){
      indexModal.style.display = "none";
    });
  }
  
  const indexOptions = document.querySelectorAll("#index-modal .index-option");
  indexOptions.forEach(button => {
    button.addEventListener("click", function(){
      window.location.href = button.dataset.url;
    });
  });
});

  </script>
</body>
</html>
